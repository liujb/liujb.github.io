<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.7.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="This is description">
<meta property="og:type" content="website">
<meta property="og:title" content="liujb&#39;s blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="liujb&#39;s blog">
<meta property="og:description" content="This is description">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="liujb&#39;s blog">
<meta name="twitter:description" content="This is description">

<link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false
  };
</script>

  <title>liujb's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">liujb's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">About tech</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags<span class="badge">8</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives<span class="badge">186</span></a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/liujb" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="default">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/03/HTTP2.0初步探索/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liujiangbei">
      <meta itemprop="description" content="This is description">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liujb's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/09/03/HTTP2.0初步探索/" class="post-title-link" itemprop="url">HTTP2.0初步探索</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2018-09-03 00:00:00 / Modified: 15:18:32" itemprop="dateCreated datePublished" datetime="2018-09-03T00:00:00+08:00">2018-09-03</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="HTTP-2的优势"><a href="#HTTP-2的优势" class="headerlink" title="HTTP/2的优势"></a>HTTP/2的优势</h1><ul>
<li>多路复用，在一个TCP连接中将所有请求并发完成。</li>
<li>服务端推送，服务端可以在客户端确认需要资源(js css)之前把资源推送到客户端，而不是客户端解析了HTML之后再做请求。</li>
<li>数据流优先（Stream Priority），HTTP/2采用二进制格式传输数据，而不是1.x那种文本格式。</li>
<li>报文头压缩，HTTP/2对报头采用HPACK算法进行压缩后传输，节省流量。</li>
<li>强制加密，虽然加密不是强制的，但是多数浏览器都是通过TLS实现的HTTP/2。</li>
</ul>
<h2 id="HTTP-1-x时代弃儿"><a href="#HTTP-1-x时代弃儿" class="headerlink" title="HTTP/1.x时代弃儿"></a>HTTP/1.x时代弃儿</h2><ul>
<li>资源文件合并（图片精灵，css&amp;js合并）在HTTP/2的协议上最好的方式使用多个小文件，而不是一个大文件</li>
<li>grunt、gulp、webpack等构建工具会被放弃使用，他们使web开发更高的复杂度</li>
<li>域名分片（为了绕开TCP并行请求数量限制）</li>
</ul>
<h2 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h2><h1 id="技术术语"><a href="#技术术语" class="headerlink" title="技术术语"></a>技术术语</h1><p>两个npm包<code>node-spdy</code>，和<code>http2</code>目前都已经过时，其中<code>node-spdy</code>兼容<code>expressjs</code></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li><a href="https://biaomingzhong.github.io/2017/http2-node-express/" target="_blank" rel="noopener">https://biaomingzhong.github.io/2017/http2-node-express/</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="default">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/03/ReactNative之APP上线有感/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liujiangbei">
      <meta itemprop="description" content="This is description">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liujb's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/09/03/ReactNative之APP上线有感/" class="post-title-link" itemprop="url">ReactNative之APP上线有感</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-09-03 00:00:00" itemprop="dateCreated datePublished" datetime="2018-09-03T00:00:00+08:00">2018-09-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-04 16:56:48" itemprop="dateModified" datetime="2020-03-04T16:56:48+08:00">2020-03-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>历经3个月的金融APP1.0正式达上线状态，终于达成阶段性目标，万事开头难所有系统的建设1.0确实也是最难的需要做的事情和面临的问题也是最多的，整个过程有点“煎熬”的所以迫不及待想要拿出来跟大家Share一下，聊聊心路历程。</p>
<h1 id="先睹为快"><a href="#先睹为快" class="headerlink" title="先睹为快"></a>先睹为快</h1><p>APP主界面图</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/Untitled.png" alt="Untitled"></p>
<blockquote>
<p>还有保险频道，但是由于资质问题暂时无法上线。</p>
</blockquote>
<p><strong>下载地址</strong><br><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/Canvas%202.png" alt="Canvas 2"></p>
<blockquote>
<p>目前还只能在内网下载，4G网络下可以正常体验</p>
</blockquote>
<p>Android正在提交应用市场，预计3-5天就能直接在市场下载，iOS由于收购滴滴金融商标所属的公司目前有“滴滴金融APP”在App store需要对方下线后我们才能提交审核。</p>
<h1 id="承上"><a href="#承上" class="headerlink" title="承上"></a>承上</h1><p>接年初我在Way社区分享的文章 <a href="http://way.xiaojukeji.com/article/6569" target="_blank" rel="noopener">滴滴金融App技术架构设计感想</a> 一文，作为前端团队的我们“主动请缨”来承接滴滴金融APP的研发工作，当时几个核心点</p>
<ol>
<li>为什么做金融APP？（战略意义+品牌落地+业务推广）</li>
<li>为什么是前端同学来做？（技术诉求+技术能力+效率至上）</li>
<li>技术选型+怎么做？（以RN为切入+借力）</li>
</ol>
<p>当时给出的总体架构设计如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/%E6%BB%B4%E6%BB%B4%E9%87%91%E8%9E%8DAPP%E6%80%BB%E4%BD%93%E6%9E%B6%E6%9E%84%E5%9B%BE.png" alt="滴滴金融APP总体架构图"></p>
<p>架构的核心想法就是借力</p>
<ol>
<li>借助平台已有的能力，不重复做工作。</li>
<li>借助过去金融Webapp的能力，保障能快速上线。</li>
</ol>
<blockquote>
<p>目前来看跟过去的设想差别不大，实施过程中也是这么做的，好处也跟当初想的差不多。</p>
</blockquote>
<h1 id="“打怪升级”"><a href="#“打怪升级”" class="headerlink" title="“打怪升级”"></a>“打怪升级”</h1><p>接下来跟大家聊聊整个过程中我们的心路历程。</p>
<h2 id="技术选型"><a href="#技术选型" class="headerlink" title="技术选型"></a>技术选型</h2><h3 id="框架选型"><a href="#框架选型" class="headerlink" title="框架选型"></a>框架选型</h3><p>我们在RN、Weex、Flutter三者之间做了比较</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15312995245315.jpg" alt=""></p>
<blockquote>
<p>最终基于团队现状我们选择了RN。</p>
</blockquote>
<h3 id="语言选择"><a href="#语言选择" class="headerlink" title="语言选择"></a>语言选择</h3><p>我们在关于使用ts和js也做了比较</p>
<h4 id="ts"><a href="#ts" class="headerlink" title="ts"></a>ts</h4><ol start="2">
<li>类型校验更容易避免低级错误。</li>
<li>可维护性更友好。</li>
<li>代码量会增多。</li>
<li>略有学习成本。</li>
</ol>
<h4 id="js"><a href="#js" class="headerlink" title="js"></a>js</h4><ol start="3">
<li>写起来更爽，可以达到随意之所至。</li>
<li>代码量相比ts会少。</li>
<li>无学习成本。</li>
<li>类型校验能力较弱（当然可以用flow来做）</li>
<li>可维护性差</li>
</ol>
<blockquote>
<p>综合结论就是想前期爽就用js，想后期爽就用ts，毫无疑问我们选择了ts。</p>
</blockquote>
<h3 id="状态管理"><a href="#状态管理" class="headerlink" title="状态管理"></a>状态管理</h3><p>我们在Mbox和Redux上也进行了相应的纠结</p>
<h4 id="Mbox"><a href="#Mbox" class="headerlink" title="Mbox"></a>Mbox</h4><ol>
<li>OOP范式相对于函数式更低的上手成本。</li>
<li>Mobx自动追踪修改。</li>
<li>多个业务store可拆分。</li>
</ol>
<h4 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h4><ol>
<li>单个store不可修改。</li>
<li>与React的配合更默契。</li>
<li>调试更加简单。</li>
</ol>
<blockquote>
<p>最终结论就是不论选择redux还是mobx对于我们来说问题都不大，所以基于大部分同学的诉求选择了redux。</p>
</blockquote>
<h2 id="接入平台SDK"><a href="#接入平台SDK" class="headerlink" title="接入平台SDK"></a>接入平台SDK</h2><p>项目启动之初我们主要是3个人来进行研发工作，其中只有一位同学拥有1年的Android经验且中间有1年多未进行Android开发，整个团队都没有iOS经验。</p>
<p><strong>当时团队的现状是</strong></p>
<ol>
<li>几乎无Native经验。</li>
<li>对Java和Object c的语法都不熟悉。</li>
<li>对工具使用如Gradle和Pod也不熟悉。</li>
</ol>
<p>我们花了差不多1个星期的时间进行了快速的学习并且写了相应的Demo就在我们认为“问题不大”的时候那就开搞！</p>
<h4 id="“欲仙欲死”的一周"><a href="#“欲仙欲死”的一周" class="headerlink" title="“欲仙欲死”的一周"></a>“欲仙欲死”的一周</h4><p>第一周团队成员可以说“欲仙欲死”，为什么呢？</p>
<p>因为有些功能我们按照文档跟相关同学的请教并且按照自己仅有的知识和过去的经验认为应该怎么怎么样的时候，发现怎么“调戏”都不好使，那种感觉真是坐立不安有过类似经验的人相信都能感同身受，但是大家又都知道不能放弃，就是不服！一瞬间我感觉自己回到了毕业之初，很多知识不健全无法串联起来的那种痛苦，毕竟这种感觉已经多年没有体验过了。</p>
<p>经历了痛苦的一周后，后续的工作就能比较顺利的开展了，还好做基础组件的同学们对我们不离不弃，陪着我们浪，这里真心给帮助过我们的同学表示感谢。</p>
<p><strong>于此同时我们也发现了平台相关的SDK之间的部分问题</strong></p>
<ol>
<li>SDK依赖关系可以说是错综复杂。</li>
<li>版本管理不够严谨。（未能严格按照3级版本的方式进行升级迭代）</li>
<li>部分SDK依赖过多。</li>
<li>文档相对代码落后。（我认为这是个共性问题，对于成熟选手可能感受不会那么浓烈，对于初级选手真的是要哭）</li>
</ol>
<p>第一版我们接入的SDK主要有</p>
<ol>
<li>Omega数据上报。</li>
<li>Crash report。</li>
<li>Webview。</li>
<li>JSBridge。</li>
<li>UnifyPassport。</li>
<li>支付组件。</li>
<li>人脸识别。</li>
</ol>
<h2 id="自己挖坑"><a href="#自己挖坑" class="headerlink" title="自己挖坑"></a>自己挖坑</h2><p>搞定大部分SDK的接入工作，我们认为最难的部分应该过去了，那就按照原型图开始画页面。这可是我们的优势啊，我们就马不停蹄的搞，看着页面在我们手里一点点出来沾沾自喜，直到我们把所有的频道+页面整合到一起后，嗯iOS还算顺滑，Android就GG了。</p>
<p>Android遇到的问题在多个tab页切换的时候会比较明显的卡顿，当时团队里边唯一有Android经验的人得出的结论“可能因为我们是单个RNApp”加载的Bundle大导致的，所以要拆分多个RNApp，并且非常确凿的说单个RNAPP还有个致命的问题就是RNApp某一处的奔溃会导致整个App崩溃。</p>
<p>所以基于此我们就相信他了，谁叫他是唯一有Android经验的人，那就陪他浪，反正我们拆解起来也非常快，因为都是组件化的思路搭建起来的页面拆完之后果然诶安卓上也顺滑多了，心中默念了一遍“问题不大”。</p>
<p>与此同时我们发现引入了新的问题，通用数据会在不同的RNApp上进行发送，这个我们还能堵住，后来发现诶多个RNApp中的通信又变麻烦了，也可以搞定，多个RNApp之间的二级页面跳转也能勉强搞，但是一路都是各种hack手段来实现，RNApp之间以及和NativeApp以及和Web之间的通信更复杂了，链路更长了，并且还遇到诸如Alert这样的会多次弹出。如果想要堵住这个问题需要改造原生的Alert或Popup一类的组件，这个时候我开始迷茫了。我意识到我们可能把事情搞砸了。</p>
<p>迷途知返，我们再一次调头，还是沿用单RNApp的，我们来专注解决Tab切换的问题就好了，后来经过不断的努力和尝试，Android的这个问题暂时得以解决。</p>
<p>过程图如下</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15313003128621.jpg" alt=""></p>
<blockquote>
<p>这个坑得出的结论就是1、步子迈大了真的容易扯到什么东西。2、技术方案不能轻易变动特别是没想清楚的前提下。</p>
</blockquote>
<h1 id="“沟沟坎坎”"><a href="#“沟沟坎坎”" class="headerlink" title="“沟沟坎坎”"></a>“沟沟坎坎”</h1><h2 id="人力问题"><a href="#人力问题" class="headerlink" title="人力问题"></a>人力问题</h2><p>前文提到我们近3个月才达到上线状态，效率不行啊 ，实际上我们的研发时间是从3.19号-4.28号，只有3个FE和一个Android工程师，接近40天时间从0到1建设的APP，我个人认为还能接受，但是QA的同学是5.28号才开始入场，所以兜兜转转才会有3个多月这么长时间。</p>
<p>这几位同学不仅承担APP本身的研发工作，还包括API层，以及某些配置类的服务层。</p>
<h2 id="司乘账号问题"><a href="#司乘账号问题" class="headerlink" title="司乘账号问题"></a>司乘账号问题</h2><p>滴滴过去的账号体系区分角色、而金融天然是个只认自然人的场景，过去我们的webapp分别投放在司机端和乘客端，取的是各自身份的token进行业务的开展，而业务侧的代码也是依赖于角色和对应的uid。</p>
<p>金融端作为面向普罗大众，我们在接入Passport的时候只能选择乘客角色，而乘客角色对于过去的webapp和业务的兼容不同程度会有体验问题。</p>
<p>我们本想基于平台已有的司乘统一的体系，但是整个服务端的接入改造需要至少3个月的时间，所以上上下下左左右右经过很多次沟通，最后还是只能沿用当前乘客端的逻辑。牺牲了一定的体验（在信贷和理财如果用户在司机端进行了实名有相应的业务数据到乘客端还需要进行一次实名绑定到该自然人）</p>
<blockquote>
<p>这个问题其实一直都有，只是在做APP的过程中会有一定程度的放开。</p>
</blockquote>
<h2 id="“滴滴金融”商标回购"><a href="#“滴滴金融”商标回购" class="headerlink" title="“滴滴金融”商标回购"></a>“滴滴金融”商标回购</h2><p>滴滴金融品牌的商标很早就被别人注册，整个团队研究了很久到底是收购商标还是重新申请商标，商标会影响APP上很多东西比如icon、slogo、软件著作权、开屏页面等等，也是一种煎熬。</p>
<h1 id="聊聊大前端的不归路"><a href="#聊聊大前端的不归路" class="headerlink" title="聊聊大前端的不归路"></a>聊聊大前端的不归路</h1><p>熟知我的朋友们都知道我是坚定在把整个团队往“全栈”的方向推进和建设，而前端毫无疑问是往“大前端”方向，今天在再次跟大家简单的回答下以下几个问题。</p>
<h2 id="为什么我要做大前端"><a href="#为什么我要做大前端" class="headerlink" title="为什么我要做大前端"></a>为什么我要做大前端</h2><h3 id="事"><a href="#事" class="headerlink" title="事"></a>事</h3><ol start="2">
<li>“套页面”时代的痛苦以及更低迭代效率。</li>
<li>“性能优化”时的掣肘和施展空间不够。</li>
<li>“跨端”“可能”带来的效率提升。</li>
</ol>
<h3 id="人"><a href="#人" class="headerlink" title="人"></a>人</h3><ol start="6">
<li>“鄙视链”底层的痛苦。</li>
<li>“可能被淘汰”的危机感。</li>
<li>坦白来讲希望扩充自己的技术边界以求在职场更好的发展。</li>
</ol>
<blockquote>
<p>基于以上毫无疑问我要做大前端。</p>
</blockquote>
<h2 id="什么是大前端"><a href="#什么是大前端" class="headerlink" title="什么是大前端"></a>什么是大前端</h2><p>笼统的讲过去的前端同学主要工作都是在利用js/css/html来做web的展示和交互，而大前端主要包括（当然不局限于此）</p>
<ol>
<li>引入“Nodejs、PHP”胶水层让整个Web应用整体衔接更紧密。</li>
<li>让前端同学拥有跨端的能力。</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15312932758397.jpg" alt=""></p>
<blockquote>
<p>前端好歹带个端字怎么可以只做页面。</p>
</blockquote>
<h2 id="为什么我们能做大前端"><a href="#为什么我们能做大前端" class="headerlink" title="为什么我们能做大前端"></a>为什么我们能做大前端</h2><p>毫无疑问得益于技术的发展，十年前不可能说走什么大前端路什么全栈几乎没这概念。近些年这几个方面的技术发展对于大前端起到了至关重要的作用。</p>
<ol>
<li>浏览器厂商对于标准的渴望越来越浓，以H5/CSS3/ES为代表的标准和步伐越来越快。</li>
<li>Nodejs为主的JS在Server端的发展打开了前端同学新的窗口。</li>
<li>RN/Weex/Flutter为代表的跨端技术呼声越来越大发展极为迅速。</li>
</ol>
<h2 id="这条路的优劣"><a href="#这条路的优劣" class="headerlink" title="这条路的优劣"></a>这条路的优劣</h2><p>毫无疑问走大前端会让自身拥有更多的技能，中国有句老话叫做技多不压身，我骨子里还是非常传统的对于这种几千年流传下来的话我是很信的。另外对于企业来说大前端意味着“更快”的效率“更低”的成本。</p>
<p>还有一层含义就是做事的人更爽了，不再被鄙视了，效率上去了，施展空间大了，没什么比在这里做事的人干着爽更重要的。</p>
<p>另外就是我深刻的体会到大前端对于人才的要求更高，这也是近期Airbab放弃RN中讲到的很重要的一个点，要求高意味这要付出更多的努力，会更加辛苦。</p>
<p>就拿我自己来说我做过Server、作为前端，现在又要来学端的知识，尽管我自认为学习能力还比较强，但是整个过程也是很痛苦并且我要想学到对端的技术融会贯通的地步我觉着这可能真的是一条不归路。</p>
<blockquote>
<p>允许我在这里说句实话，大前端在国内的大企业不见得很受待见有客观的也有主观的原因，这也是不归路的点，有兴趣的朋友我们可以私下交流。</p>
</blockquote>
<h1 id="启下"><a href="#启下" class="headerlink" title="启下"></a>启下</h1><h2 id="忘掉招式"><a href="#忘掉招式" class="headerlink" title="忘掉招式"></a>忘掉招式</h2><p><strong>临阵杀敌忘掉所有招式</strong></p>
<p>这是我想对我和团队同学们要说的，过去我们总说我们在做RN，实际上经过这段时间的演变，我也开始在质问和质疑我自己，引入RN是否真的提高了效率，是否真的因为引入了RN所有的前端同学就都能做APP开发了，是不是我把事情搞复杂啦，我看到引入RN又增加了一层通信的成本过去APP只需要跟Webview里边的js进行通信就能拥有混合型APP的能力，现在还需要跟RN通过桥接的方式进行通信。</p>
<p>所以忘掉招式把，我们是在探索是最适合团队和以及相比于传统的端的开发模式更高效的方式。不排除有一天我会移除RN或者又引入新的什么跨端技术如Flutter等等。</p>
<h2 id="APP接下来的重点"><a href="#APP接下来的重点" class="headerlink" title="APP接下来的重点"></a>APP接下来的重点</h2><ol>
<li>增强Web开发者的开发体验，增强Webapp本身的能力和体验。</li>
<li>金融APP的安全和风控能力。</li>
<li>辅助工具（如<a href="https://mcodepush.xiaojukeji.com" target="_blank" rel="noopener">热更新服务</a>基于开源完成部署可直接于内部团队）</li>
<li>可能有的RN生态（如组件库的建设）</li>
</ol>
<h1 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h1><p>最后还是感谢，在为期3个多月的研发工作中，很多人都给予了极大地支持包括但不限于</p>
<ul>
<li>平台组的大左、龙熠的鼓励和支持。</li>
<li>基础组件和工具的同学如（Omega、Apollo、Webview、JSBridge、UnifyPassport、人脸识别、收银台SDK）等兄弟姐妹们。</li>
<li>还有个国际化”不靠谱“的王佳佳给予了我们iOS基础能力的传授。</li>
<li>曾经的谷雨客户端的兄弟（于洋、王栋）手把手的教我们。</li>
<li>最后是曼哈顿直接参与的产品设计和研发测试的同学们你们“很可爱”</li>
<li>还有支持我们的市场、品牌、PR、法务的同学们。</li>
</ul>
<p>历史永远是往前发展，技术和开发模式同样如此，人亦当也是如此，我们在走一条不一样的路也许没有归期，路途中也许会孤独可能会无助，知道为什么以及可能会到哪里很重要，共勉！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="default">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/02/Android技术初步探索/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liujiangbei">
      <meta itemprop="description" content="This is description">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liujb's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/09/02/Android技术初步探索/" class="post-title-link" itemprop="url">Android技术初步探索</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-09-02 00:00:00" itemprop="dateCreated datePublished" datetime="2018-09-02T00:00:00+08:00">2018-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-09-03 15:06:37" itemprop="dateModified" datetime="2018-09-03T15:06:37+08:00">2018-09-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Activity相关"><a href="#Activity相关" class="headerlink" title="Activity相关"></a>Activity相关</h1><h2 id="活动被回收了怎么办"><a href="#活动被回收了怎么办" class="headerlink" title="活动被回收了怎么办"></a>活动被回收了怎么办</h2><p>活动有个 onSaveInstanceState(Bundle outState) 回调可以在活动被回收前保存数据，然后再次启动活动的时候恢复数据。</p>
<h2 id="Activity有4种启动模式"><a href="#Activity有4种启动模式" class="headerlink" title="Activity有4种启动模式"></a>Activity有4种启动模式</h2><ul>
<li>standard：每次启动活动都会入“返回栈”栈顶</li>
</ul>
<ol start="2">
<li>singleTop：在启动活动时如果发现“返回栈”的“栈顶”已经是该活动，则直接使用不会创建新的活动。</li>
<li>singleTask：每次启动活动系统首先会检查“返回栈”是否有该活动，如果发现已经存在则直接使用否则创建新的活动。</li>
<li>singleInstance：会启动新的“返回栈”来管理该活动，主要用于其他程序和我们的程序“共享”活动实例。</li>
</ol>
<p>其中“返回栈”是一种叫法，实际为栈的数据结构保存的返回记录。</p>
<h2 id="知晓当前页面处于哪个Activity"><a href="#知晓当前页面处于哪个Activity" class="headerlink" title="知晓当前页面处于哪个Activity"></a>知晓当前页面处于哪个Activity</h2><p>可以创建BaseActivity（继承自APPCompactActivity），让APP的所有Activity都集成自BaseActivity，然后在BaseActivity的onCreate方法中进行Log.d追踪，这样你就能随时随地的知晓当前页面对应哪个Activity。</p>
<h2 id="随时随地退出应用？"><a href="#随时随地退出应用？" class="headerlink" title="随时随地退出应用？"></a>随时随地退出应用？</h2><p>实现ActivityController，创建List<activity>，在每个Activity中进行add和remove，同时提供finishAll方法，这样只需要在对应的地方调用finishAll方法进行APP的退出。</activity></p>
<p>当然也可以直接使用killProcess(android.os.Process.myPid())直接退出。</p>
<h2 id="启动活动的最佳写法"><a href="#启动活动的最佳写法" class="headerlink" title="启动活动的最佳写法"></a>启动活动的最佳写法</h2><p>在Activity中定义actionStart(Context context, String data1, String data2)方法，然后调用该方法即可方便的知道该Activity启动的时候需要什么参数。</p>
<h1 id="控件相关"><a href="#控件相关" class="headerlink" title="控件相关"></a>控件相关</h1><p>四中布局方式？</p>
<ol>
<li>线性布局</li>
<li>相对布局</li>
<li>帧布局</li>
</ol>
<h1 id="广播相关"><a href="#广播相关" class="headerlink" title="广播相关"></a>广播相关</h1><p>广播接收器中不要有过多的计算或者耗时的操作，因为onReceive()中不允许开启线程。</p>
<h2 id="注册广播有两种方式"><a href="#注册广播有两种方式" class="headerlink" title="注册广播有两种方式"></a>注册广播有两种方式</h2><ul>
<li><p>在代码中注册（动态注册），此方式注册的广播记得要取消注册，一般在onDestory()方法中，这里有个缺陷就是必须程序启动才能接收到广播，优势就是比较灵活。</p>
</li>
<li><p>在AndroidManifest.xml中注册（静态注册）</p>
</li>
</ul>
<h2 id="广播类型"><a href="#广播类型" class="headerlink" title="广播类型"></a>广播类型</h2><ol>
<li>标准广播：完全异步的广播，广播发出后所有广播接收器几乎同时接收到广播且无法被截断，他们之间无先后顺序可言。</li>
<li>有序广播：同步执行的广播，广播发出后同一时刻只有一个接收器能接收到广播，有先后顺序（通过设置优先级的方式确定先后顺序），且可以截断广播<code>abortBroadcast()</code>。</li>
</ol>
<h2 id="广播属性"><a href="#广播属性" class="headerlink" title="广播属性"></a>广播属性</h2><ol>
<li>全局广播：所有的APP都能接受到，有安全隐患</li>
<li>本地广播：只能在APP内部接收到，无安全隐患，无法静态注册，这也很好理解因为静态注册的广播就是为了程序在未启动的情况下也能接收到广播，而发送本地广播的时候毫无疑问程序已经启动。</li>
</ol>
<h1 id="持久化相关"><a href="#持久化相关" class="headerlink" title="持久化相关"></a>持久化相关</h1><h2 id="三种存储方式"><a href="#三种存储方式" class="headerlink" title="三种存储方式"></a>三种存储方式</h2><ol>
<li>文件：适合简单的文本数据</li>
<li>ShardPreference：键值对的方式，能存储多种数据类型，最终也是以XML的形式存储。</li>
<li>数据库存储：SQLite、LitePal。</li>
</ol>
<p>三种方法获得SharedPreferenceduixiang</p>
<ol>
<li>Context.getSharedPreference()</li>
<li>Activity类中的getPreference()方法</li>
<li>PreferenceManager类中的getDefaultSharedPreference()方法</li>
</ol>
<p>记住密码的Case，在ForceLogoutTest工程内。</p>
<h1 id="内容提供器（ContentProvider）"><a href="#内容提供器（ContentProvider）" class="headerlink" title="内容提供器（ContentProvider）"></a>内容提供器（ContentProvider）</h1><p>主要作用是为不同程序之间提供数据共享。</p>
<h2 id="权限机制"><a href="#权限机制" class="headerlink" title="权限机制"></a>权限机制</h2><p>6.0之前都是在安装的时候给到用户提示，如果用户认可APP需要申请的权限就允许安装，否则阻止安装即可，当然这很容易形成“店大欺客”的现象，于是6.0之后加入了运行时权限，可以在软件使用过程中再对某一项权限进行授权。    </p>
<h2 id="ContentResover"><a href="#ContentResover" class="headerlink" title="ContentResover"></a>ContentResover</h2><p>通过Context的getContentResolver可以访问别的程序共享出来的数据</p>
<h1 id="Notification相关"><a href="#Notification相关" class="headerlink" title="Notification相关"></a>Notification相关</h1><p>在哪里可以创建通知</p>
<ol>
<li>活动里。</li>
<li>广播接收器。</li>
</ol>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li><a href="https://blog.csdn.net/qq895767507/article/details/80271933" target="_blank" rel="noopener">vivo x21通过Android studio 安装失败</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="default">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/02/PHP之Laravel开发环境搭建疑惑/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liujiangbei">
      <meta itemprop="description" content="This is description">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liujb's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/09/02/PHP之Laravel开发环境搭建疑惑/" class="post-title-link" itemprop="url">PHP之Laravel开发环境搭建疑惑</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-09-02 00:00:00" itemprop="dateCreated datePublished" datetime="2018-09-02T00:00:00+08:00">2018-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-09-03 11:39:28" itemprop="dateModified" datetime="2018-09-03T11:39:28+08:00">2018-09-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本文用于记录Laravel环境搭建过程中遇到的几个概念进行记录</p>
<ol>
<li>laravel homestead 是什么？</li>
<li>vagrant 是什么？</li>
</ol>
<h1 id="Homestead是什么？"><a href="#Homestead是什么？" class="headerlink" title="Homestead是什么？"></a>Homestead是什么？</h1><p>Laravel Homestead是一个官方的、预封装的Vagrant“箱子”。</p>
<p>它提供给你一个奇妙的开发环境而不需要你在本机上安装PHP、HHVM、web服务器和其它的服务器软件。不用再担心搞乱你的操作系统！Vagrant箱子是完全可支配的。如果出现故障，你可以在几分种内完成销毁和重建箱子！</p>
<p>Homestead能运行在所有的Windows、Mac或Linux系统上，它包含了Nginx、PHP 5.6、MySQL、Postgres、Redis、Memcached和你开发神奇的Laravel应用程序需要的所有其它软件。</p>
<h1 id="vagrant是什么？"><a href="#vagrant是什么？" class="headerlink" title="vagrant是什么？"></a>vagrant是什么？</h1><p>Vagrant是用来管理虚拟机的，如VirtualBox、VMware、AWS等。</p>
<p>主要好处是可以提供一个可配置、可移植和复用的软件环境，可以使用shell、chef、puppet等工具部署。所以vagrant不能单独使用，如果你用它来管理自己的开发环境的话，必须在自己的电脑里安装了虚拟机软件，我使用的是virtualbox。</p>
<p>Vagrant提供一个命令行工具vagrant，通过这个命令行工具可以直接启动一个虚拟机，当然你需要提前定义一个Vagrantfile文件，这有点类似Dockerfile之于docker了。</p>
<p>跟docker类比这来看vagrant就比较好理解了，vagrant也是用来提供一致性环境的，vagrant本身也提供一个镜像源，使用vagrant init hashicorp/precise64就可以初始化一个Ubuntu 12.04的镜像。</p>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><ul>
<li><a href="https://laravel-china.org/articles/4668/why-do-you-have-to-use-homestead-to-develop-laravel-applications" target="_blank" rel="noopener">为什么使用Homestead来开发Laravel</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="default">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/02/ReactNative之Android平台Bundle探索/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liujiangbei">
      <meta itemprop="description" content="This is description">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liujb's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/09/02/ReactNative之Android平台Bundle探索/" class="post-title-link" itemprop="url">ReactNative之Android平台Bundle探索</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-09-02 00:00:00" itemprop="dateCreated datePublished" datetime="2018-09-02T00:00:00+08:00">2018-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-04 16:56:48" itemprop="dateModified" datetime="2020-03-04T16:56:48+08:00">2020-03-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在RN的开发过程中，Android平台若Build为Debug模式，打出来的JS Bundle代码没有经过混淆和压缩，导致的JS Bundle体积会比较大。</p>
<p>由于在测试环境下RN在性能上表现的不尽人意，我们初步揣测会不会是JS Bundle体积偏大且开发者模式需要做其他额外的工作导致的。为了验证该结论，所以我们希望Android在Build模式为Debug，同时JS Bundle为production并且代码经过混淆和压缩来论证我们的揣测。</p>
<h1 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h1><h2 id="手动构建JS-Bundle"><a href="#手动构建JS-Bundle" class="headerlink" title="手动构建JS Bundle"></a>手动构建JS Bundle</h2><p>通过如下命令手动构建JS Bundle</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node node_modules/react-native/local-cli/cli.js bundle --entry-file index.js --platform android --dev false --bundle-output ./android/app/src/main/assets/index.android.bundle --assets-dest android/app/src/main/res</span><br></pre></td></tr></table></figure>
<p>特意指定 –dev false 表示我们希望用 production 模式构建 JS Bundle。</p>
<h2 id="构建APK包"><a href="#构建APK包" class="headerlink" title="构建APK包"></a>构建APK包</h2><p>通过如下命令进行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd android &amp;&amp; ./gradlew clean assembleDebug</span><br></pre></td></tr></table></figure>
<p>此时指定打 Android 的Debug包。</p>
<p>按照预定的路径，此时解析app-debug.apk，应该拿到的JS Bundle 是经过混淆和压缩且模式为production。但是结果却并非如此，如图</p>
<p>由此可以得出我们的设想的JS Bundle构建的过程是不正确的。</p>
<h1 id="探索"><a href="#探索" class="headerlink" title="探索"></a>探索</h1><p>在 ./android/app/build.gradle 有如下代码指定如何构建ReactNative</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">project.ext.react = [</span><br><span class="line">  entryFile: &quot;index.js&quot;,</span><br><span class="line">  nodeExecutableAndArgs: [&quot;/usr/local/bin/node&quot;]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>按照理解这块并没有做什么额外的工作，只是指定了入口文件和Nodejs的执行路径。再看看 在 ./node_modules/react-native/react.gradle 配置文件中我们可以看到诸如</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/WechatIMG87.jpeg" alt="react.gradle"></p>
<p>由此可以看出我们可以指定 bundleInDebug 配置</p>
<ul>
<li>true表示 Debug模式进行JS Bundle构建，</li>
<li>false表示 Debug模式下不打JS Bundle。</li>
</ul>
<h2 id="直接构建"><a href="#直接构建" class="headerlink" title="直接构建"></a>直接构建</h2><p>我们做了次尝试，不预先往 android/app/src/main/assets/ 打JS Bundle文件，也就是不执行bundle命令，直接执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew assembleDebug</span><br></pre></td></tr></table></figure>
<p>并且没有指定bundleInDebug为任何值，这种情况下我们通过解析生成的APK包，发现APK包内没有JS Bundle文件。</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/WX20180903-134937@2x.png" alt=""></p>
<p>此时启动APP会访问JS Bundle Server来请求bundle文件。</p>
<h2 id="预先构建JS-Bundle"><a href="#预先构建JS-Bundle" class="headerlink" title="预先构建JS Bundle"></a>预先构建JS Bundle</h2><p>这次预先设定JS Bundle并且指定为production模式，此时设定 bundleInDebug 为 false</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">project.ext.react = [</span><br><span class="line">  entryFile: &quot;index.js&quot;,</span><br><span class="line">  nodeExecutableAndArgs: [&quot;/usr/local/bin/node&quot;],</span><br><span class="line">  bundleInDebug: false</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>这样执行 <code>./gradlew assembleDebug</code> 时，不会再次进行JS Bundle的过程，会直接把预先打包的JS文件拷贝到APK内，此时APP正常运行。通过解压APK包，发现JS Bundle文件为预先构建的Bundle文件。</p>
<p>过程如下，先进行JS打包</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/WechatIMG66.png" alt=""></p>
<p>然后执行 ./gradlew assebleDebug</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/WX20180903-150119@2x.png" alt=""></p>
<h2 id="JS-Bundle相关结论"><a href="#JS-Bundle相关结论" class="headerlink" title="JS Bundle相关结论"></a>JS Bundle相关结论</h2><p>通过以上探索，我们得到部分结论。</p>
<ul>
<li>Android 原生部分若使用Debug模式构建，预先构建的JS Bundle会被覆盖。在 <code>./gradlew assembleRelease</code> 内部会进行JS Bundle打包。</li>
<li>Android 原生部分若使用Debug模式构建，并且JS Bundle为<strong>Dev模式</strong>，APP启动时会去请求 JS Bundle server。</li>
<li>Android 原生部分若使用Debug模式构建，JS Bundle为<strong>非DEV模式</strong>，APP启动正常。</li>
</ul>
<p>另外执行 <code>gradlew assembleDebug</code> 会将 android/app/src/main/assets/index.android.bundle  copy 到 android/app/build/intermediates/assets/debug/index.android.bundle。</p>
<h1 id="解惑"><a href="#解惑" class="headerlink" title="解惑"></a>解惑</h1><p>Android 原生部分若使用Debug模式构建，可以通过设置 bundleInDebug 来指定是否在构建过程中生成JS Bundle。</p>
<p>最初我们未设置bundleInDebug，所以在gradlew assembleDebug并不会对js进行打包，但是凑巧的是我们在这种情况下也预先利用命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node node_modules/react-native/local-cli/cli.js bundle --entry-file index.js --platform android --dev true --bundle-output ./android/app/src/main/assets/index.android.bundle --assets-dest android/app/src/main/res</span><br></pre></td></tr></table></figure>
<p>预先构建了bundle文件到assets，凑巧在assets这个目录下的内容会被copy，所以bundle生效，APP一切正常。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="default">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/24/Hash和加密的理论以及相关应用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liujiangbei">
      <meta itemprop="description" content="This is description">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liujb's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/05/24/Hash和加密的理论以及相关应用/" class="post-title-link" itemprop="url">Hash和加密的理论以及相关应用</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-05-24 00:00:00" itemprop="dateCreated datePublished" datetime="2018-05-24T00:00:00+08:00">2018-05-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-04 16:56:48" itemprop="dateModified" datetime="2020-03-04T16:56:48+08:00">2020-03-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="理论知识"><a href="#理论知识" class="headerlink" title="理论知识"></a>理论知识</h1><p>密码学要解决的问题：</p>
<ul>
<li>机密性</li>
<li>完整性</li>
<li>身份验证（抗抵赖性）</li>
</ul>
<h2 id="差别"><a href="#差别" class="headerlink" title="差别"></a>差别</h2><ol>
<li><code>hash</code> 是将目标文本转换成具有相同长度、不可逆的杂凑字符串（消息摘要）</li>
<li><code>encrypt</code> 是将目标文本转换成不同长度，可逆的密文。</li>
</ol>
<h2 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h2><p>散列算法（Hash Algorithm），又称哈希算法，杂凑算法。</p>
<h3 id="常用的hash方法"><a href="#常用的hash方法" class="headerlink" title="常用的hash方法"></a>常用的hash方法</h3><ol>
<li>md2/md3/md4/md5</li>
<li>SHA-1，SHA-2（SHA-224、SHA-256、SHA-384，和SHA-512统称SHA-2）</li>
<li>SHA-3，之前名为Keccak算法，是一个加密杂凑算法。</li>
<li>HAVAL，不常用</li>
<li>Tiger，不常用</li>
<li>RIPEMD，不常用</li>
</ol>
<h3 id="hash算法的特点"><a href="#hash算法的特点" class="headerlink" title="hash算法的特点"></a>hash算法的特点</h3><ul>
<li>正向快速：给定明文和 hash 算法，在有限时间和有限资源内能计算出 hash 值。</li>
<li>逆向困难：给定（若干） hash 值，在有限时间内很难（基本不可能）逆推出明文。</li>
<li>输入敏感：原始输入信息修改一点信息，产生的 hash 值看起来应该都有很大不同。</li>
<li>冲突避免：很难找到两段内容不同的明文，使得它们的 hash 值一致（发生冲突）。即对于任意两个不同的数据块，其hash值相同的可能性极小；对于一个给定的数据块，找到和它hash值相同的数据块极为困难。</li>
</ul>
<p>参考内容</p>
<ul>
<li><a href="https://www.jianshu.com/p/bf1d7eee28d0" target="_blank" rel="noopener">参考</a></li>
<li><a href="http://www.atool.org/hash.php" target="_blank" rel="noopener">哈希算法</a></li>
</ul>
<h2 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h2><p>分为对称加密和非对称加密。</p>
<h3 id="对称加密"><a href="#对称加密" class="headerlink" title="对称加密"></a>对称加密</h3><p>对称密码技术：发件人和收件人使用其共同拥有的单个密钥，这种密钥既用于加密，也用于解密，叫做机密密钥(也称为对称密钥或会话密钥)。</p>
<h4 id="对称加密特性"><a href="#对称加密特性" class="headerlink" title="对称加密特性"></a>对称加密特性</h4><ul>
<li>用户只需记忆一个密钥，就可用于加密、解密；</li>
<li>与非对称加密方法相比，加密解密的计算量小，速度快，简单易用，适合于对海量数据进行加密处理。</li>
</ul>
<h4 id="对称加密的缺点"><a href="#对称加密的缺点" class="headerlink" title="对称加密的缺点"></a>对称加密的缺点</h4><p>如果密钥交换不安全，密钥的安全性就会丧失。特别是在电子商务环境下，当客户是未知的、不可信的实体时，如何使客户安全地获得密钥就成为一大难题。</p>
<h4 id="常用对称加密"><a href="#常用对称加密" class="headerlink" title="常用对称加密"></a>常用对称加密</h4><p>DES、3DES、Blowfish、IDEA、RC4、RC5、RC6和AES、Rijndael</p>
<blockquote>
<p>最常用的DES、3DES、AES</p>
</blockquote>
<h3 id="非对称加密"><a href="#非对称加密" class="headerlink" title="非对称加密"></a>非对称加密</h3><p>使用一对密钥：一个用于加密信息，另一个则用于解密信息，反之亦然。</p>
<ul>
<li>公钥(Public key)常用于数据加密（用对方公钥加密）或签名验证（用对方公钥解密）。</li>
<li>私钥(Private key)常用于数据解密（发送方用接收方公钥加密）或签名（用自己私钥加密）。</li>
</ul>
<blockquote>
<p>密钥依据性质划分，将其中的一个向外界公开，称为公钥；另一个则自己保留，称为私钥。</p>
</blockquote>
<h4 id="非对称加密的特性"><a href="#非对称加密的特性" class="headerlink" title="非对称加密的特性"></a>非对称加密的特性</h4><ul>
<li>两个密钥之间存在着相互依存关系：即用其中任一个密钥加密的信息只能用另一个密钥进行解密。</li>
<li>其中加密密钥不同于解密密钥，公钥加密私钥解密，反之也可私钥加密公钥解密。</li>
</ul>
<h4 id="常用非对称加密"><a href="#常用非对称加密" class="headerlink" title="常用非对称加密"></a>常用非对称加密</h4><ul>
<li>Diffie-Hellman ：最早产生，计算离散对数，是一种密钥交换协定算法，不加密、不产生数字签名。</li>
<li>RSA：大素数分解，可加密，可签名</li>
<li>EI Gamal ：离散对数，可加密，可签名，最慢</li>
<li>椭圆曲线：计算离散对数，功能与RSA相似，更快</li>
<li>DSA：EI的变种，离散对数，不加密，可签名，比RSA慢</li>
<li>背包：背包算法，可加密，可签名，已淘汰</li>
<li>DSS：数字签名标准</li>
</ul>
<blockquote>
<p>最常用RSA、DSS</p>
</blockquote>
<h1 id="常见应用"><a href="#常见应用" class="headerlink" title="常见应用"></a>常见应用</h1><p><a href="http://blog.51cto.com/lidongfeng/2068348" target="_blank" rel="noopener">该部分功能主要是引用</a>，中间夹杂这部分自己的理解以及格式的优化。</p>
<h2 id="对称加密的应用（实现机密性）"><a href="#对称加密的应用（实现机密性）" class="headerlink" title="对称加密的应用（实现机密性）"></a>对称加密的应用（实现机密性）</h2><p>假设Alice和Bob是认识的，两人为了保证通信消息不被其它人截取，预先约定了一个密码，用来加密在他们之间传送的消息，这样即使有人截取了消息没有密码也无法知道消息的内容。由此便实现了机密性。</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15271558510780/15277522343723.png" alt=""></p>
<blockquote>
<p>缺点，以上的实现过程存在以下问题</p>
</blockquote>
<ol>
<li>如果Alice和Bob是在互联网中彼此不认识的，那么Alice该如何和Bob协商（或者说传送）共享密钥（密码）？</li>
<li>如果Alice要和100个人通信，他需要记住多少个密码？和1000个、10000个人……通信呢？</li>
<li>如果Alice和其它人通信使用了和Bob相同的密码，那么如何知道这个消息一定是来自Bob呢？</li>
</ol>
<p>由此就引入了非对称密码。</p>
<h2 id="非对称加密应用（缺乏身份完整性）"><a href="#非对称加密应用（缺乏身份完整性）" class="headerlink" title="非对称加密应用（缺乏身份完整性）"></a>非对称加密应用（缺乏身份完整性）</h2><ol>
<li>首先，Alice为了保证消息的机密性，用Bob的公钥加密了数据，</li>
<li>这样就只能用Bob的私钥解密消息，所以只有Bob才能看到消息。</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15271558510780/15277523830328.png" alt=""></p>
<blockquote>
<p>缺点，这固然实现了机密性，然而Bob如何验证消息是来自Alice呢，因为任何人都可以得到Bob的公钥。</p>
</blockquote>
<h2 id="解决非对称加密（身份完整性）"><a href="#解决非对称加密（身份完整性）" class="headerlink" title="解决非对称加密（身份完整性）"></a>解决非对称加密（身份完整性）</h2><p>Alice为了向Bob证明消息确实是她发的</p>
<ol>
<li>用自己的私钥加密消息然后发送给Bob。</li>
<li>Bob用Alice的公钥解密了消息，于是知道了消息的确是Alice发的。</li>
</ol>
<p>因为只有用Alice私钥加密的消息才能用她的公钥解密。</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15271558510780/15277524400413.png" alt=""></p>
<blockquote>
<p>缺点，这样便实现了身份验证，然而任何人都可以用Alice的公钥来解密消息，这样<strong>机密性又无从保证了</strong>。</p>
</blockquote>
<p>于是又有了下面这种方式</p>
<ol>
<li>Alice先用自己的私钥加密数据（实现身份验证）</li>
<li>然后再用Bob的公钥再次加密刚才加密过的消息密文（实现机密性）</li>
<li>然后发送给Bob。</li>
<li>Bob先用自己的私钥解密。</li>
<li>再用Alice的公钥解密。</li>
</ol>
<p>如此便实现了机密性和身份验证。</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15271558510780/15277524763622.png" alt=""></p>
<blockquote>
<p>缺点，非对称算法本身就耗资源，运算速度慢，此处还加密了两次，对于批量数据是绝对不可接受的，有没有更好的办法呢？由此又引入了下面的混合加密。</p>
</blockquote>
<h2 id="混合加密"><a href="#混合加密" class="headerlink" title="混合加密"></a>混合加密</h2><blockquote>
<p>混合加密简单的说就是用非对称算法交换对称秘钥，用对称密钥加密数据。</p>
</blockquote>
<p>混合加密的过程</p>
<ol>
<li>Alice先随机生成一个会话密钥。</li>
<li>然后用这个会话密钥加密消息。</li>
<li>再用Bob的公钥加密会话密钥。</li>
<li>然后把消息密文和会话密钥密文（数字信封）都发送给Bob。</li>
<li>Bob收到消息先用自己的私钥解密数字信封。</li>
<li>得到会话秘钥。</li>
<li>再用会话密钥解密消息密文。</li>
</ol>
<p>混合加密整个过程图</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15271558510780/15277525144106.png" alt=""></p>
<blockquote>
<p>注意，这里不能实现身份验证，Alice无法向Bob证明消息是自己发的。同时也无法防止篡改。</p>
</blockquote>
<p>为了验证身份，引入消息摘要，过程描述如下</p>
<ol>
<li>Alice使用散列算法对消息计算出消息摘要1。</li>
<li>然后把消息摘要1附在消息明文后面一并发送给Bob。</li>
<li>Bob收到消息后使用相同的散列算法对消息明文计算出消息摘要2。</li>
<li>然后和消息摘要1比较。</li>
<li>如果相同则表示消息未遭到篡改。</li>
</ol>
<p>过程图示</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15271558510780/15277525469321.png" alt=""></p>
<blockquote>
<p>缺点：简单的这样做并不能实现真正的完整性，假如有人在中间截获消息修改后重新计算消息摘要附在后面，Bob依然认为消息未遭到篡改。同时也不能实现身份验证，于是便有了数字签名。</p>
</blockquote>
<h2 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h2><blockquote>
<p>数字签名是指用户用自己的私钥对原始数据的哈希摘要(Hash digest)进行加密所得的数据。</p>
</blockquote>
<ol>
<li>信息接收者使用<strong>信息发送者的公钥</strong>对附在原始信息后的数字签名进行解密后<strong>获得哈希摘要</strong>。</li>
<li>通过与自己用收到的原始数据产生的哈希摘要对照，以确认以下两点：<ul>
<li>信息是由签名者发送的（身份验证、不可抵赖性）</li>
<li>信息自签发后到收到为止未曾信得过任何修改（完整性）</li>
</ul>
</li>
</ol>
<h3 id="数字签名标准"><a href="#数字签名标准" class="headerlink" title="数字签名标准"></a>数字签名标准</h3><p>在1991年，NIST提议了一个为数字签名标准（Digital Signature Standard，DSS）的联邦标准 FIPS 186（ 使用SHA），它最近一次更新实在2013年，作为FIPS 186-4被发布，包括了DSA、RSA、ECC</p>
<p>DSS有两种创建签名的方法DSA和RSA。与RSA不同，DSA只能用于数字签名，并且比RSA慢，RSA能够用于数字签名、加密以及密钥分发。</p>
<h3 id="数字签名的过程"><a href="#数字签名的过程" class="headerlink" title="数字签名的过程"></a>数字签名的过程</h3><p>如下过程</p>
<ol>
<li>Alice用散列算法计算出消息摘要。</li>
<li>然后用自己的私钥<strong>加密消息摘要</strong>（数字签名）</li>
<li>然后将消息明文和数字签名一起发送给Bob。</li>
<li>Bob收到消息用Alice的公钥解密数字签名得到原消息摘要（验证了Alice的身份）。</li>
<li>用相同的散列算法对消息计算消息摘要。</li>
<li>然后将两个消息摘要进行比较，如果消息摘要相同则表示消息没有遭到篡改。（完整性）</li>
</ol>
<blockquote>
<p>注意：这里假如有第三者Tom进行中间人攻击，他可以篡改消息，也可以重新计算消息摘要，但是Tom却没有Alice的私钥来加密消息摘要，此时如果Tom用自己的私钥加密消息摘要，当Bob收到消息后用Alice的公钥将无法解密数字签名得到消息摘要原文。</p>
</blockquote>
<p>构成示意图</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15271558510780/15277525927390.png" alt=""></p>
<p>从上面可以看出，在这些实现过程中，公钥至关重要，那么我们又如何验证用户的公钥，就像本文的例子中，Alice如何得到Bob的公钥，得到公钥后又如何验证这个公钥就是Bob的？此时就需要一个双方都信任的第三方机构，由此引入PKI。</p>
<h2 id="PKI"><a href="#PKI" class="headerlink" title="PKI"></a>PKI</h2><p>PKI是由软件、通信协议、数据格式、安全策略等用于使用、管理、控制公钥密码体制的一套系统。</p>
<p>它主要有三个目的：</p>
<ul>
<li>发布公钥/证书，</li>
<li>证明绑定公钥的实体，</li>
<li>提供一个公钥有效性的验证</li>
</ul>
<p>PKI提供基本服务：</p>
<ul>
<li>机密性</li>
<li>完整性</li>
<li>访问控制</li>
<li>真实性</li>
<li>不可否认性</li>
</ul>
<h3 id="数字证书"><a href="#数字证书" class="headerlink" title="数字证书"></a>数字证书</h3><p>PKI技术采用证书管理公钥，通过第三方的可信任机构认证中心CA (Certificate Authority)，把用户的公钥和用户的其他标识信息（如名称、email、身份证号等）捆绑在一起，在Internet网上验证用户的身份。</p>
<p>公钥证书是以数字方式签名的声明，它将公钥的值与持有相应私钥的主体(个人、设备和服务)的身份绑定在一起。通过在证书上签名，CA可以核实与证书上公钥相应的私钥为证书所指定的主体所拥有。</p>
<p>数字证书的格式是由CCITT X.509国际标准所规定的，它包含了以下几点：</p>
<ul>
<li>证书拥有者的姓名</li>
<li>证书拥有者的公钥</li>
<li>公钥的有效期</li>
<li>颁发数字证书的单位</li>
<li>数字证书的序列号(Serial number)</li>
<li>CA的名称，并用CA的数字签名签署该证书</li>
<li>CA所遵循的用来确定证书主体身份策略的标识符</li>
<li>在证书中标识的密钥对(公钥及相关的私钥)的用法</li>
<li>证书废止列表(CRL)的位置</li>
</ul>
<p>ITU-T X.509并非证书的惟一格式。例如，Pretty Good Privacy (PGP)安全电子邮件是依赖PGP所独有的一种证书。</p>
<h3 id="CA"><a href="#CA" class="headerlink" title="CA"></a>CA</h3><blockquote>
<p>负责发放和管理数字证书的权威机构</p>
</blockquote>
<h4 id="具体功能"><a href="#具体功能" class="headerlink" title="具体功能"></a>具体功能</h4><ul>
<li>接收验证RA转发来的最终用户数字证书的申请。</li>
<li>确定是否接受最终用户数字证书的申请-证书的审批。</li>
<li>生成密钥对和证书</li>
<li>向申请者颁发证书</li>
<li>为签发的证书提供组织与责任的权威公证</li>
<li>接收最终用户数字证书的查询、撤销。</li>
<li>产生和发布证书废止列表（CRL）</li>
<li>密钥管理(密钥备份、密钥恢复、密钥更新)</li>
<li>数字证书的归档。</li>
<li>密钥归档</li>
<li>历史数据归档。</li>
</ul>
<p>简单的说，PKI实现的功能就是用一个大家都信任的机构CA给用户颁发一个数字证书，证书中包含用户的公钥（这个公钥可以是用户自己生成的提交给CA的也可以是CA生成发给用户的）及相关身份信息。</p>
<p>以本文的Alice和Bob为例，Alice为了向Bob证明自己是Alice和某个公钥是自己的，</p>
<ol>
<li>她便向一个Alice和Bob都信任的CA机构申请证书，</li>
<li>Alice先自己生成了一对密钥对（私钥和公钥），</li>
<li>把自己的私钥保存在自己电脑上，</li>
<li>然后把公钥给CA申请证书，</li>
<li>CA接受申请于是给Alice颁发了一个数字证书，证书中包含了Alice的那个公钥以及其它身份信息，当然，CA会计算这些信息的消息摘要并用自己的私钥加密消息摘要（数字签名）一并附在Alice的证书上，以此来证明这个证书就是CA自己颁发的。</li>
<li>Bob得到Alice的证书后用CA的证书（自签署的）中的公钥来解密消息摘要，</li>
<li>这样就确认Alice的证书是CA发的，</li>
<li>证书中的信息未遭到篡改，同时也得到了Alice的公钥。</li>
</ol>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul>
<li><a href="http://blog.51cto.com/lidongfeng/2068348" target="_blank" rel="noopener">对称密码、非对称密码、散列算法与PKI</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="default">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/17/UUID知识记录和整理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liujiangbei">
      <meta itemprop="description" content="This is description">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liujb's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/05/17/UUID知识记录和整理/" class="post-title-link" itemprop="url">UUID知识记录和整理</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-05-17 00:00:00" itemprop="dateCreated datePublished" datetime="2018-05-17T00:00:00+08:00">2018-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-08-30 15:33:53" itemprop="dateModified" datetime="2018-08-30T15:33:53+08:00">2018-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>过往工作中UUID经常用到，但缺乏整理和归纳，特此记录。</p>
<h1 id="UUID简介"><a href="#UUID简介" class="headerlink" title="UUID简介"></a>UUID简介</h1><p>UUID（Universally Unique Identifier）全局唯一标识符，是指在一台机器上生成的数字，它保证对在同一时空中的所有机器都是唯一的。</p>
<p>UUID是一个由4个连字号(-)将32个字节长的字符串分隔后生成的字符串，总共36个字节长。比如：<code>550e8400-e29b-41d4-a716-446655440000</code></p>
<p>按照开放软件基金会（OSF）制定的<a href="https://tools.ietf.org/html/rfc4122" target="_blank" rel="noopener">标准</a>计算，用到了以太网卡地址、纳秒级时间、芯片ID码和许多可能的数字。</p>
<p>为了保证UUID的唯一性，规范定义了</p>
<ul>
<li>网卡MAC地址</li>
<li>时间戳</li>
<li>名字空间（Namespace）</li>
<li>随机或伪随机数</li>
<li>时序等元素</li>
</ul>
<p>以及从这些元素生成UUID的算法。UUID的复杂特性在保证了其唯一性的同时，意味着只能由计算机生成。UUID的唯一缺陷在于生成的结果串会比较长。</p>
<h1 id="不同版本"><a href="#不同版本" class="headerlink" title="不同版本"></a>不同版本</h1><h2 id="UUID-Version-1：基于时间的UUID"><a href="#UUID-Version-1：基于时间的UUID" class="headerlink" title="UUID Version 1：基于时间的UUID"></a>UUID Version 1：基于时间的UUID</h2><p>基于时间的UUID通过计算当前时间戳、随机数和机器MAC地址得到。由于在算法中使用了MAC地址，这个版本的UUID可以保证在全球范围的唯一性。</p>
<p>但与此同时，使用MAC地址会带来安全性问题，这就是这个版本UUID受到批评的地方。</p>
<p>如果应用只是在局域网中使用，也可以使用退化的算法，以IP地址来代替MAC地址 – Java的UUID往往是这样实现的（当然也考虑了获取MAC的难度）。</p>
<h2 id="UUID-Version-2：DCE安全的UUID"><a href="#UUID-Version-2：DCE安全的UUID" class="headerlink" title="UUID Version 2：DCE安全的UUID"></a>UUID Version 2：DCE安全的UUID</h2><p>DCE（Distributed Computing Environment）安全的UUID和基于时间的UUID算法相同，但会把时间戳的前4位置换为POSIX的UID或GID。这个版本的UUID在实际中较少用到。</p>
<h2 id="UUID-Version-3：基于名字的UUID（MD5）"><a href="#UUID-Version-3：基于名字的UUID（MD5）" class="headerlink" title="UUID Version 3：基于名字的UUID（MD5）"></a>UUID Version 3：基于名字的UUID（MD5）</h2><p>基于名字的UUID通过计算名字和名字空间的MD5散列值得到。</p>
<p>这个版本的UUID保证了</p>
<ul>
<li>相同名字空间中不同名字生成的UUID的唯一性；</li>
<li>不同名字空间中的UUID的唯一性；</li>
<li>相同名字空间中相同名字的UUID重复生成是相同的。</li>
</ul>
<h2 id="UUID-Version-4：随机UUID"><a href="#UUID-Version-4：随机UUID" class="headerlink" title="UUID Version 4：随机UUID"></a>UUID Version 4：随机UUID</h2><p>根据随机数，或者伪随机数生成UUID。</p>
<p>这种UUID产生重复的概率是可以计算出来的，但随机的东西就像是买彩票，你指望它发财是不可能的，但狗屎运通常会在不经意中到来。</p>
<h2 id="UUID-Version-5：基于名字的UUID（SHA1）"><a href="#UUID-Version-5：基于名字的UUID（SHA1）" class="headerlink" title="UUID Version 5：基于名字的UUID（SHA1）"></a>UUID Version 5：基于名字的UUID（SHA1）</h2><p>和版本3的UUID算法类似，只是散列值计算使用SHA1（Secure Hash Algorithm 1）算法。</p>
<h1 id="UUID的应用"><a href="#UUID的应用" class="headerlink" title="UUID的应用"></a>UUID的应用</h1><p><strong>从UUID的不同版本可以看出</strong></p>
<ul>
<li>Version 1/2适合应用于分布式计算环境下，具有高度的唯一性；</li>
<li>Version 3/5适合于一定范围内名字唯一，且需要或可能会重复生成UUID的环境下；</li>
<li>至于Version 4，我个人的建议是最好不用（虽然它是最简单最方便的）。</li>
</ul>
<p><strong>但以下情况最好不使用UUID</strong></p>
<ul>
<li>映射类型的对象。比如只有代码及名称的代码表。</li>
<li>人工维护的非系统生成对象。比如系统中的部分基础数据。</li>
<li>对于具有名称不可重复的自然特性的对象，最好使用Version 3/5的UUID。比如系统中的用户。如果用户的UUID是Version 1的，如果你不小心删除了再重建用户，你会发现人还是那个人，用户已经不是那个用户了。（虽然标记为删除状态也是一种解决方案，但会带来实现上的复杂性。）</li>
</ul>
<h1 id="和GUID的区别"><a href="#和GUID的区别" class="headerlink" title="和GUID的区别"></a>和GUID的区别</h1><p>GUID是UUID的标准实现，换言之UUID是定义标准，GUID是微软对标准的具体实现，我们自己也可以实现UUID，写出UUID生成器。</p>
<p><a href="http://www.blogjava.net/feelyou/archive/2008/10/14/234320.html" target="_blank" rel="noopener">参考文章</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="default">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/08/VSCode调试Typescript项目/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liujiangbei">
      <meta itemprop="description" content="This is description">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liujb's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/05/08/VSCode调试Typescript项目/" class="post-title-link" itemprop="url">VSCode调试Typescript项目</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-05-08 00:00:00" itemprop="dateCreated datePublished" datetime="2018-05-08T00:00:00+08:00">2018-05-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-04 16:56:48" itemprop="dateModified" datetime="2020-03-04T16:56:48+08:00">2020-03-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>个人一直有个不好的习惯，调试喜欢用console.log，在小项目逻辑不复杂的情况下这种方式也不是完全不可取吧，但是项目逻辑复杂且依赖的环节多时，这种方式就有点抓瞎啦，刚好今年把团队开发语言从过去的js/es过渡到typescript了，在调试typescript的时候遇到了点问题，特此记录。</p>
<h1 id="设置调试"><a href="#设置调试" class="headerlink" title="设置调试"></a>设置调试</h1><h2 id="设置调试启动的类型和相关参数"><a href="#设置调试启动的类型和相关参数" class="headerlink" title="设置调试启动的类型和相关参数"></a>设置调试启动的类型和相关参数</h2><p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15257488256816/15257497963515.jpg" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  // Use IntelliSense to learn about possible attributes.</span><br><span class="line">  // Hover to view descriptions of existing attributes.</span><br><span class="line">  // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span><br><span class="line">  &quot;version&quot;: &quot;0.2.0&quot;,</span><br><span class="line">  &quot;configurations&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;node&quot;,</span><br><span class="line">      &quot;request&quot;: &quot;launch&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;DEBUG&quot;,</span><br><span class="line">      &quot;program&quot;: &quot;$&#123;workspaceRoot&#125;/src/app.ts&quot;,</span><br><span class="line">      &quot;cwd&quot;: &quot;$&#123;workspaceRoot&#125;&quot;,</span><br><span class="line">      &quot;console&quot;: &quot;internalConsole&quot;,</span><br><span class="line">      &quot;env&quot;: &#123;</span><br><span class="line">        &quot;NODE_ENV&quot;: &quot;development&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;sourceMaps&quot;: true,</span><br><span class="line">      &quot;runtimeArgs&quot;: [</span><br><span class="line">        &quot;--nolazy&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;outFiles&quot;: [</span><br><span class="line">        &quot;$&#123;workspaceRoot&#125;/output/**/*.js&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="tsconfig-js配置"><a href="#tsconfig-js配置" class="headerlink" title="tsconfig.js配置"></a>tsconfig.js配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;compilerOptions&quot;: &#123;</span><br><span class="line">    &quot;target&quot;: &quot;ES6&quot;,</span><br><span class="line">    &quot;module&quot;: &quot;CommonJS&quot;,</span><br><span class="line">    &quot;sourceMap&quot;: true,</span><br><span class="line">    &quot;noEmitHelpers&quot;: true,</span><br><span class="line">    &quot;importHelpers&quot;: true,</span><br><span class="line">    &quot;allowUnreachableCode&quot;: false,</span><br><span class="line">    &quot;removeComments&quot;: true,</span><br><span class="line">    &quot;moduleResolution&quot;: &quot;node&quot;,</span><br><span class="line">    &quot;lib&quot;: [&quot;es5&quot;, &quot;es6&quot;],</span><br><span class="line">    &quot;typeRoots&quot;: [</span><br><span class="line">      &quot;node_modules/@types&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;types&quot;: [</span><br><span class="line">      &quot;node&quot;,</span><br><span class="line">      &quot;lodash&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;outDir&quot;: &quot;./output&quot;,</span><br><span class="line">    &quot;rootDir&quot;: &quot;./src&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;exclude&quot;: [</span><br><span class="line">    &quot;node_modules&quot;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意sourcemap必须为true</p>
</blockquote>
<h1 id="启动调试"><a href="#启动调试" class="headerlink" title="启动调试"></a>启动调试</h1><p>点击绿色的指示icon，就可以正常启动调试进程。</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15257488256816/15257506211444.jpg" alt=""></p>
<h1 id="遇到问题"><a href="#遇到问题" class="headerlink" title="遇到问题"></a>遇到问题</h1><p>我的项目在开发阶段通过<code>yarn run dev</code> 实际为（<code>gulp default</code>）可以启动，只要通过这种方式启动后，关掉服务，再次启动调试就会出现如图</p>
<p><img src="https://cdn.jsdelivr.net/gh/liujb/imgbed/img/15257488256816/15257501432322.jpg" alt=""></p>
<p>解决方案，重新 <code>npm run tsc</code> (<code>rm -fr output &amp;&amp; tsc</code>) 就OK了，猜测是<code>watch</code>的时候 <code>map</code> 文件错乱了，所以找不到具体的js文件。</p>
<h1 id="参考内容"><a href="#参考内容" class="headerlink" title="参考内容"></a>参考内容</h1><ul>
<li><a href="https://code.visualstudio.com/docs/editor/debugging" target="_blank" rel="noopener">code.visualstudio.com/docs/editor/debugging</a></li>
<li><a href="https://medium.com/@dupski/debug-typescript-in-vs-code-without-compiling-using-ts-node-9d1f4f9a94a" target="_blank" rel="noopener">debug-typescript-in-vs-code-without-compiling-using-ts-node</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="default">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/04/Android平台adb使用记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liujiangbei">
      <meta itemprop="description" content="This is description">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liujb's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/05/04/Android平台adb使用记录/" class="post-title-link" itemprop="url">Android平台adb工具使用记录</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-05-04 00:00:00" itemprop="dateCreated datePublished" datetime="2018-05-04T00:00:00+08:00">2018-05-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-09-01 22:25:45" itemprop="dateModified" datetime="2018-09-01T22:25:45+08:00">2018-09-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><h2 id="安装-amp-卸载"><a href="#安装-amp-卸载" class="headerlink" title="安装&amp;卸载"></a>安装&amp;卸载</h2><ul>
<li>设备列表 <code>db devices</code></li>
<li>安装apk <code>adb install xxxx.apk</code></li>
<li>指定模拟器安装apk <code>adb -s 79e4d661 install  app/build/outputs/apk/app-release.apk</code></li>
<li>卸载包 <code>adb uninstall com.codepushexample</code></li>
</ul>
<h2 id="模拟器截图"><a href="#模拟器截图" class="headerlink" title="模拟器截图"></a>模拟器截图</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb shell /system/bin/screencap -p /sdcard/screenshot.png</span><br><span class="line">adb pull /sdcard/screenshot.png /Users/xx/Desktop</span><br></pre></td></tr></table></figure>
<h1 id="附属完整帮助"><a href="#附属完整帮助" class="headerlink" title="附属完整帮助"></a>附属完整帮助</h1><p>adb命令非常强大，完整的命令帮助信息如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">didi@bogon:~/Code/App/code-push-example/android » adb --help                                                                                                                                     1 ↵</span><br><span class="line">Android Debug Bridge version 1.0.39</span><br><span class="line">Version 0.0.1-4500957</span><br><span class="line">Installed as /Users/didi/Library/Android/sdk/platform-tools/adb</span><br><span class="line"></span><br><span class="line">global options:</span><br><span class="line"> -a         listen on all network interfaces, not just localhost</span><br><span class="line"> -d         use USB device (error if multiple devices connected)</span><br><span class="line"> -e         use TCP/IP device (error if multiple TCP/IP devices available)</span><br><span class="line"> -s SERIAL  use device with given serial (overrides $ANDROID_SERIAL)</span><br><span class="line"> -t ID      use device with given transport id</span><br><span class="line"> -H         name of adb server host [default=localhost]</span><br><span class="line"> -P         port of adb server [default=5037]</span><br><span class="line"> -L SOCKET  listen on given socket for adb server [default=tcp:localhost:5037]</span><br><span class="line"></span><br><span class="line">general commands:</span><br><span class="line"> devices [-l]             list connected devices (-l for long output)</span><br><span class="line"> help                     show this help message</span><br><span class="line"> version                  show version num</span><br><span class="line"></span><br><span class="line">networking:</span><br><span class="line"> connect HOST[:PORT]      connect to a device via TCP/IP [default port=5555]</span><br><span class="line"> disconnect [HOST[:PORT]]</span><br><span class="line">     disconnect from given TCP/IP device [default port=5555], or all</span><br><span class="line"> forward --list           list all forward socket connections</span><br><span class="line"> forward [--no-rebind] LOCAL REMOTE</span><br><span class="line">     forward socket connection using:</span><br><span class="line">       tcp:&lt;port&gt; (&lt;local&gt; may be &quot;tcp:0&quot; to pick any open port)</span><br><span class="line">       localabstract:&lt;unix domain socket name&gt;</span><br><span class="line">       localreserved:&lt;unix domain socket name&gt;</span><br><span class="line">       localfilesystem:&lt;unix domain socket name&gt;</span><br><span class="line">       dev:&lt;character device name&gt;</span><br><span class="line">       jdwp:&lt;process pid&gt; (remote only)</span><br><span class="line"> forward --remove LOCAL   remove specific forward socket connection</span><br><span class="line"> forward --remove-all     remove all forward socket connections</span><br><span class="line"> ppp TTY [PARAMETER...]   run PPP over USB</span><br><span class="line"> reverse --list           list all reverse socket connections from device</span><br><span class="line"> reverse [--no-rebind] REMOTE LOCAL</span><br><span class="line">     reverse socket connection using:</span><br><span class="line">       tcp:&lt;port&gt; (&lt;remote&gt; may be &quot;tcp:0&quot; to pick any open port)</span><br><span class="line">       localabstract:&lt;unix domain socket name&gt;</span><br><span class="line">       localreserved:&lt;unix domain socket name&gt;</span><br><span class="line">       localfilesystem:&lt;unix domain socket name&gt;</span><br><span class="line"> reverse --remove REMOTE  remove specific reverse socket connection</span><br><span class="line"> reverse --remove-all     remove all reverse socket connections from device</span><br><span class="line"></span><br><span class="line">file transfer:</span><br><span class="line"> push [--sync] LOCAL... REMOTE</span><br><span class="line">     copy local files/directories to device</span><br><span class="line">     --sync: only push files that are newer on the host than the device</span><br><span class="line"> pull [-a] REMOTE... LOCAL</span><br><span class="line">     copy files/dirs from device</span><br><span class="line">     -a: preserve file timestamp and mode</span><br><span class="line"> sync [system|vendor|oem|data|all]</span><br><span class="line">     sync a local build from $ANDROID_PRODUCT_OUT to the device (default all)</span><br><span class="line">     -l: list but don&apos;t copy</span><br><span class="line"></span><br><span class="line">shell:</span><br><span class="line"> shell [-e ESCAPE] [-n] [-Tt] [-x] [COMMAND...]</span><br><span class="line">     run remote shell command (interactive shell if no command given)</span><br><span class="line">     -e: choose escape character, or &quot;none&quot;; default &apos;~&apos;</span><br><span class="line">     -n: don&apos;t read from stdin</span><br><span class="line">     -T: disable PTY allocation</span><br><span class="line">     -t: force PTY allocation</span><br><span class="line">     -x: disable remote exit codes and stdout/stderr separation</span><br><span class="line"> emu COMMAND              run emulator console command</span><br><span class="line"></span><br><span class="line">app installation:</span><br><span class="line"> install [-lrtsdg] PACKAGE</span><br><span class="line"> install-multiple [-lrtsdpg] PACKAGE...</span><br><span class="line">     push package(s) to the device and install them</span><br><span class="line">     -l: forward lock application</span><br><span class="line">     -r: replace existing application</span><br><span class="line">     -t: allow test packages</span><br><span class="line">     -s: install application on sdcard</span><br><span class="line">     -d: allow version code downgrade (debuggable packages only)</span><br><span class="line">     -p: partial application install (install-multiple only)</span><br><span class="line">     -g: grant all runtime permissions</span><br><span class="line"> uninstall [-k] PACKAGE</span><br><span class="line">     remove this app package from the device</span><br><span class="line">     &apos;-k&apos;: keep the data and cache directories</span><br><span class="line"></span><br><span class="line">backup/restore:</span><br><span class="line">   to show usage run &quot;adb shell bu help&quot;</span><br><span class="line"></span><br><span class="line">debugging:</span><br><span class="line"> bugreport [PATH]</span><br><span class="line">     write bugreport to given PATH [default=bugreport.zip];</span><br><span class="line">     if PATH is a directory, the bug report is saved in that directory.</span><br><span class="line">     devices that don&apos;t support zipped bug reports output to stdout.</span><br><span class="line"> jdwp                     list pids of processes hosting a JDWP transport</span><br><span class="line"> logcat                   show device log (logcat --help for more)</span><br><span class="line"></span><br><span class="line">security:</span><br><span class="line"> disable-verity           disable dm-verity checking on userdebug builds</span><br><span class="line"> enable-verity            re-enable dm-verity checking on userdebug builds</span><br><span class="line"> keygen FILE</span><br><span class="line">     generate adb public/private key; private key stored in FILE,</span><br><span class="line">     public key stored in FILE.pub (existing files overwritten)</span><br><span class="line"></span><br><span class="line">scripting:</span><br><span class="line"> wait-for[-TRANSPORT]-STATE</span><br><span class="line">     wait for device to be in the given state</span><br><span class="line">     State: device, recovery, sideload, or bootloader</span><br><span class="line">     Transport: usb, local, or any [default=any]</span><br><span class="line"> get-state                print offline | bootloader | device</span><br><span class="line"> get-serialno             print &lt;serial-number&gt;</span><br><span class="line"> get-devpath              print &lt;device-path&gt;</span><br><span class="line"> remount</span><br><span class="line">     remount /system, /vendor, and /oem partitions read-write</span><br><span class="line"> reboot [bootloader|recovery|sideload|sideload-auto-reboot]</span><br><span class="line">     reboot the device; defaults to booting system image but</span><br><span class="line">     supports bootloader and recovery too. sideload reboots</span><br><span class="line">     into recovery and automatically starts sideload mode,</span><br><span class="line">     sideload-auto-reboot is the same but reboots after sideloading.</span><br><span class="line"> sideload OTAPACKAGE      sideload the given full OTA package</span><br><span class="line"> root                     restart adbd with root permissions</span><br><span class="line"> unroot                   restart adbd without root permissions</span><br><span class="line"> usb                      restart adb server listening on USB</span><br><span class="line"> tcpip PORT               restart adb server listening on TCP on PORT</span><br><span class="line"></span><br><span class="line">internal debugging:</span><br><span class="line"> start-server             ensure that there is a server running</span><br><span class="line"> kill-server              kill the server if it is running</span><br><span class="line"> reconnect                kick connection from host side to force reconnect</span><br><span class="line"> reconnect device         kick connection from device side to force reconnect</span><br><span class="line"> reconnect offline        reset offline/unauthorized devices to force reconnect</span><br><span class="line"></span><br><span class="line">environment variables:</span><br><span class="line"> $ADB_TRACE</span><br><span class="line">     comma-separated list of debug info to log:</span><br><span class="line">     all,adb,sockets,packets,rwx,usb,sync,sysdeps,transport,jdwp</span><br><span class="line"> $ADB_VENDOR_KEYS         colon-separated list of keys (files or directories)</span><br><span class="line"> $ANDROID_SERIAL          serial number to connect to (see -s)</span><br><span class="line"> $ANDROID_LOG_TAGS        tags to be used by logcat (see logcat --help)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="default">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/04/ReactNative安卓构建Release包/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liujiangbei">
      <meta itemprop="description" content="This is description">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liujb's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/05/04/ReactNative安卓构建Release包/" class="post-title-link" itemprop="url">ReactNative安卓构建Release包</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-05-04 00:00:00" itemprop="dateCreated datePublished" datetime="2018-05-04T00:00:00+08:00">2018-05-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-08-30 15:38:23" itemprop="dateModified" datetime="2018-08-30T15:38:23+08:00">2018-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h1><ul>
<li>Mac电脑</li>
<li>标准的ReactNative项目</li>
</ul>
<h1 id="打包过程"><a href="#打包过程" class="headerlink" title="打包过程"></a>打包过程</h1><h2 id="第1步，生成签名钥"><a href="#第1步，生成签名钥" class="headerlink" title="第1步，生成签名钥"></a>第1步，生成签名钥</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -genkey -v -keystore my-release-key.keystore -alias my-key-alias -keyalg RSA -keysize 2048 -validity 10000</span><br></pre></td></tr></table></figure>
<p>然后按照提示输入密码，以及其他附属信息。</p>
<h2 id="第2步，设置gradle变量"><a href="#第2步，设置gradle变量" class="headerlink" title="第2步，设置gradle变量"></a>第2步，设置gradle变量</h2><ul>
<li>将第1步生成的签名串，移动到 android/app/ 目录下</li>
<li>编辑 ~/.gradle/gradle.properties 或者 android/gradle.properties，内容如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MYAPP_RELEASE_STORE_FILE=my-release-key.keystore</span><br><span class="line">MYAPP_RELEASE_KEY_ALIAS=my-key-alias</span><br><span class="line">MYAPP_RELEASE_STORE_PASSWORD=*****</span><br><span class="line">MYAPP_RELEASE_KEY_PASSWORD=*****</span><br></pre></td></tr></table></figure>
<h2 id="第3步，编辑android-app-build-gradle"><a href="#第3步，编辑android-app-build-gradle" class="headerlink" title="第3步，编辑android/app/build.gradle"></a>第3步，编辑android/app/build.gradle</h2><p>注意<code>signingConfigs</code> 和 <code>buildTypes</code> 两个节点</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    defaultConfig &#123; ... &#125;</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            if (project.hasProperty(&apos;MYAPP_RELEASE_STORE_FILE&apos;)) &#123;</span><br><span class="line">                storeFile file(MYAPP_RELEASE_STORE_FILE)</span><br><span class="line">                storePassword MYAPP_RELEASE_STORE_PASSWORD</span><br><span class="line">                keyAlias MYAPP_RELEASE_KEY_ALIAS</span><br><span class="line">                keyPassword MYAPP_RELEASE_KEY_PASSWORD</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            ...</span><br><span class="line">            signingConfig signingConfigs.release</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h2 id="第4步，执行命令"><a href="#第4步，执行命令" class="headerlink" title="第4步，执行命令"></a>第4步，执行命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd android &amp;&amp; ./gradlew assembleRelease</span><br></pre></td></tr></table></figure>
<p>至此，如果代码本身没有问题的话，打Release包的过程应该顺利完成</p>
<h1 id="其他信息"><a href="#其他信息" class="headerlink" title="其他信息"></a>其他信息</h1><h2 id="生成的包所在位置"><a href="#生成的包所在位置" class="headerlink" title="生成的包所在位置"></a>生成的包所在位置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android/app/build/outputs/apk/app-release.apk</span><br></pre></td></tr></table></figure>
<h2 id="测试Release包"><a href="#测试Release包" class="headerlink" title="测试Release包"></a>测试Release包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native run-android --variant=release</span><br></pre></td></tr></table></figure>
<h2 id="安装Release包"><a href="#安装Release包" class="headerlink" title="安装Release包"></a>安装Release包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb install android/app/build/outputs/apk/app-release.apk</span><br></pre></td></tr></table></figure>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://facebook.github.io/react-native/docs/signed-apk-android.html" target="_blank" rel="noopener">Generating Signed APK</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="liujiangbei"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">liujiangbei</p>
  <div class="site-description" itemprop="description">This is description</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">186</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/liujb" title="GitHub → https://github.com/liujb" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:liujiangbei88@gmail.com" title="Mail → mailto:liujiangbei88@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/PrivateGuess" title="Twitter → https://twitter.com/PrivateGuess" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liujiangbei</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.7.1
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://pisces.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  

</body>
</html>
